# Використовуйте безпечну та ієрархічну конфігурацію з урахуванням середовища

<br/><br/>

### Пояснення за один абзац

Під час роботи з конфігураційними даними багато речей можуть просто дратувати та гальмувати:

1. налаштування всіх ключів за допомогою змінних середовища процесу стає дуже виснажливим, коли потрібно вставити 100 ключів (замість того, щоб просто закріпити їх у файлі конфігурації), однак, коли ви маєте справу з файлами, лише адміністратори DevOps не можуть змінити поведінку, не змінюючи код. Надійне конфігураційне рішення має поєднувати обидва файли конфігурації + перевизначення змінних процесу

2. при вказівці всіх ключів у плоскому JSON стає неприємно знаходити та змінювати записи, коли список стає більшим. Ієрархічний файл JSON, згрупований у розділи, може подолати цю проблему + кілька бібліотек конфігурації дозволяють зберігати конфігурацію в кількох файлах і подбати про об’єднання всіх під час виконання. Дивіться приклад нижче

3. зберігати конфіденційну інформацію, як-от пароль БД, очевидно, не рекомендується, але швидкого та зручного рішення для цієї проблеми не існує. Деякі бібліотеки конфігурації дозволяють шифрувати файли, інші шифрують ці записи під час фіксації GIT або просто не зберігають реальні значення для цих записів і вказують фактичне значення під час розгортання за допомогою змінних середовища.

4. деякі розширені сценарії конфігурації вимагають введення значень конфігурації через командний рядок (vargs) або синхронізації конфігураційної інформації через централізований кеш, як-от Redis, щоб кілька серверів використовували однакові конфігураційні дані.

5. програма має вийти з ладу якомога швидше та забезпечити негайний зворотний зв’язок, якщо необхідні змінні середовища відсутні під час запуску, цього можна досягти за допомогою [convict](https://www.npmjs.com/package/convict) щоб перевірити конфігурацію.

Деякі бібліотеки конфігурації можуть надавати більшість із цих функцій безкоштовно, подивіться на бібліотеки npm, наприклад [rc](https://www.npmjs.com/package/rc), [nconf](https://www.npmjs. com/package/nconf), [config](https://www.npmjs.com/package/config) і [convict](https://www.npmjs.com/package/convict), які відповідають багатьом з цих вимоги.

<br/><br/>

### Приклад коду – ієрархічна конфігурація допомагає знаходити записи та підтримувати величезні файли конфігурації

```json5
{
  // Конфігурації модуля клієнта
  "Customer": {
    "dbConfig": {
      "host": "localhost",
      "port": 5984,
      "dbName": "customers"
    },
    "credit": {
      "initialLimit": 100,
      // Встановити низький для розробки
      "initialDays": 1
    }
  }
}
```

<br/><br/>
